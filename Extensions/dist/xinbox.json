{"id":"xinbox","script":"//* TITLE XInbox **//\r\n//* VERSION 1.9.1 **//\r\n//* DESCRIPTION Enhances your Inbox experience **//\r\n//* DEVELOPER STUDIOXENIX **//\r\n//* DETAILS XInbox allows you to tag posts before posting them, and see all your messages at once, and lets you delete multiple messages at once using the Mass Editor mode. To use this mode, go to your Inbox and click on the Mass Editor Mode button on your sidebar, click on the messages you want to delete then click the Delete Messages button.  **//\r\n//* FRAME false **//\r\n//* BETA false **//\r\n\r\nXKit.extensions.xinbox = new Object({\r\n\r\n\trunning: false,\r\n\r\n\treply_button_icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM5MzFGNzM2MzgzMTFFMzlFQTI4RjEwOUZBNDg2OEYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM5MzFGNzQ2MzgzMTFFMzlFQTI4RjEwOUZBNDg2OEYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzkzMUY3MTYzODMxMUUzOUVBMjhGMTA5RkE0ODY4RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzkzMUY3MjYzODMxMUUzOUVBMjhGMTA5RkE0ODY4RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmGYpQYAAAIwSURBVHjaYoyKimJABkGRyUwb1q6QOnXiaOa7N6+9Pnx4r/rnzx8OmLyAoNA9MXGJ9V6+AX1A7ktkvYzIhgEN4inKTZnw6MH9BAZU8A2IvwCxGLKgjKx874Rp82qBzF8gPhNM4vrN2yblRZnrkAyaAcSeQCwExHxALAXEbEBsBcRTQQqePH5YXJCVOB/IhLgc5LKK2hYRIPMPFM8GYmMGwiARpkdaRnbams17mRhAhJy8wiKoxGQgZmcgHkTADLR1cDZh/vXrp+TJ40fnQSUT0AOVALgCxCxAbAvE/Aya2roZUNPXMpAH5EH6Obm4XjH9/vVLHSp4l0zDHoGI79++CTH9+ftHACr4kUzDWGEMUNJ4C2Xzk2mYNlgzv8BDJgVF5WVQwSIyDUwBEZJS0itASYNFWVVtAzQSykk0qAGWNPomzxFkZmH88+/L1+8Sz589dYNmmVVEGCIKxM1AXAbiANNp4Yljhw6C0gjD3z9/2KCKfiJp0ABlVyB+DMTM0KwEMsQIiP1himTlFCr7pswFZy+wYR8/fTCHyp2CKgalvSR8TgOG9UpVdQ2Q627MnNoHFmMxtXbmWbZsGcwmGaiBYKCuqb3286ePQkxMTP+BBcwvFlaW11xc3Kc0tHQ2RMUmg3LKP5QiSEVNI+nOrRuzkAWVlFWnJ6Xl1AGZ70mJDRaG///hxZCCkvIib7+gKiDzxfPnT0hOI4zApMGVn5kQYmputScmIe0FutNJAQABBgBSobK3EYqShQAAAABJRU5ErkJggg==\",\r\n\r\n\tpreferences: {\r\n\t\t\"sep-1\": {\r\n\t\t\ttext: \"Notifications\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"show_new_notification\": {\r\n\t\t\ttext: \"Show an XKit Notification when I receive new asks/fan mail\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"sep0\": {\r\n\t\t\ttext: \"Tagging while publishing\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"show_tag_box\": {\r\n\t\t\ttext: \"Show the tag input box on asks\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"tag_usernames\": {\r\n\t\t\ttext: \"Tag published asks with their usernames\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"tag_usernames_replace_hyphens\": {\r\n\t\t\ttext: \"Replace hyphens in usernames with spaces when tagging\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"anon_tag\": {\r\n\t\t\ttext: \"Tag to use when the asker is anonymous\",\r\n\t\t\tdefault: \"Anonymous\",\r\n\t\t\tvalue: \"Anonymous\",\r\n\t\t\ttype: \"text\"\r\n\t\t},\r\n\t\t\"tag_custom\": {\r\n\t\t\ttext: \"Tag published asks with the custom tag below:\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"custom_tag\": {\r\n\t\t\ttext: \"Custom tag for asks\",\r\n\t\t\tdefault: \"\",\r\n\t\t\tvalue: \"\",\r\n\t\t\ttype: \"text\"\r\n\t\t},\r\n\t\t\"sep1a\": {\r\n\t\t\ttext: \"Appearance options\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"show_reply_button\": {\r\n\t\t\ttext: \"Show Reply button on Private Answers I receive (requires User Menus+ installed)\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"bigger_answer_boxes\": {\r\n\t\t\ttext: \"Make the answer box taller when I'm typing a reply to an ask\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"sep1\": {\r\n\t\t\ttext: \"Inbox Tools\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"inbox_search\": {\r\n\t\t\ttext: \"Enable Inbox Search\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true,\r\n\t\t\texperimental: true\r\n\t\t},\r\n\t\t\"mass_editor\": {\r\n\t\t\ttext: \"Enable Mass Inbox Editor\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"check_for_blanks\": {\r\n\t\t\ttext: \"Confirm my action when I'm about to publish a blank ask\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"sep2\": {\r\n\t\t\ttext: \"Fan Mail options\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"auto_expand_fan_mail\": {\r\n\t\t\ttext: \"Automatically expand Fan Mail without having to click on Read More\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"slim_fan_mail\": {\r\n\t\t\ttext: \"Slim Incoming Fan Mail\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"slim_outgoing_fan_mail\": {\r\n\t\t\ttext: \"Slim Fan Mail when I'm writing one\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\t\"hide_fan_mail_button\": {\r\n\t\t\ttext: \"Hide 'Send Fan Mail' button\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t}\r\n\t},\r\n\r\n\tframe_run: function() {\r\n\r\n\t\tXKit.extensions.xinbox.slimify_outgoing();\r\n\r\n\t},\r\n\r\n\tslimify_outgoing: function() {\r\n\r\n\t\tif (XKit.extensions.xinbox.preferences.slim_outgoing_fan_mail.value === true) {\r\n\r\n\t\t\tXKit.tools.add_css(\"#fan_mail { background-image: url('http://xkit.info/seven/extension_assets/paper.png'); }#fan_mail #message{ overflow-y: scroll; font-size: 15px !important; line-height: 22px !important; }\", \"xinbox_slim_outgoing_fan_mail\");\r\n\r\n\t\t\t$(document).on('click', '#paper_white-lined-1', function() {\r\n\r\n\t\t\t\t$(\"#fan_mail\").css(\"background-image\",\"url('http://xkit.info/seven/extension_assets/paper.png')\");\r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tnotification_check_interval: 0,\r\n\tlast_check: 0,\r\n\r\n\tcheck_for_new: function(first) {\r\n\r\n\t\tif ($(\"#inbox_button\").length <= 0) { return; }\r\n\r\n\t\tvar m_value = parseInt($(\"#inbox_button\").find(\".tab_notice_value\").html());\r\n\r\n\t\tif (first === true) {\r\n\t\t\tXKit.extensions.xinbox.last_check = m_value;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (m_value > 0 && XKit.extensions.xinbox.last_check !== m_value) {\r\n\r\n\t\t\tXKit.notifications.add(\"You have <b>\" + m_value + \"</b> new ask/fan mail in your Inbox.\", \"mail\", false, function() { window.open(\"http://www.tumblr.com/inbox\"); });\r\n\t\t\tXKit.extensions.xinbox.last_check = m_value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\trun: function() {\r\n\t\tthis.running = true;\r\n\t\tXKit.tools.init_css(\"xinbox\");\r\n\r\n\t\tXKit.extensions.xinbox.slimify_outgoing();\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.show_new_notification.value === true) {\r\n\t\t\tXKit.extensions.xinbox.notification_check_interval = setInterval(function() { XKit.extensions.xinbox.check_for_new(); }, 2000);\r\n\t\t\tXKit.extensions.xinbox.check_for_new(true);\r\n\t\t}\r\n\r\n\t\tif (XKit.interface.where().inbox !== true) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\r\n\t\tif (XKit.extensions.xinbox.preferences.show_reply_button.value === true) {\r\n\t\t\t$(document).on('click','.xkit-xinbox-pa-reply', XKit.extensions.xinbox.on_click_to_pa_reply);\r\n\t\t\tXKit.interface.create_control_button(\"xkit-xinbox-pa-reply\", this.reply_button_icon, \"Reply to Answer\", \"\");\r\n\t\t\tXKit.post_listener.add(\"xinbox_show_reply_buttons\", XKit.extensions.xinbox.show_reply_button);\r\n\t\t\tXKit.extensions.xinbox.show_reply_button();\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.show_tag_box.value === true || XKit.extensions.xinbox.preferences.tag_usernames.value === true || XKit.extensions.xinbox.preferences.tag_custom.value === true) {\r\n\t\t\tXKit.post_listener.add(\"xinbox_init_tags\", XKit.extensions.xinbox.init_tags);\r\n\t\t\tXKit.extensions.xinbox.init_tags();\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.hide_fan_mail_button.value === true && $(\"#right_column > .send_fan_mail\").length > 0) {\r\n\t\t\tXKit.tools.add_css(\"#right_column > .send_fan_mail { display: none; } #right_column .controls_section { margin-top: 0 !important; margin-bottom: 18px; } \", \"xkit_inbox_hide_fan_mail_button\");\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.slim_fan_mail.value === true) {\r\n\t\t\tvar m_css = \" .fan_mail .message { \" +\r\n\t\t\t\t\t\t\" background: white !important; \" +\r\n\t\t\t\t\t\t\" padding-left: 20px !important; padding-right: 20px !important; \" +\r\n\t\t\t\t\t\t\" padding-bottom: 37px !important; padding-top: 20px !important; \" +\r\n\t\t\t\t\t\t\" border-radius: 6px !important; \" +\r\n\t\t\t\t\t\t\" font: normal 14px/1.4 \\\"Helvetica Neue\\\",\\\"HelveticaNeue\\\",Helvetica,Arial,sans-serif !important; \" +\r\n\t\t\t\t\t\" }\" +\r\n\t\t\t\t\t\" .post.fan_mail.lined-white .before { display: none; } \" +\r\n\t\t\t\t\t\" #posts .post.fan_mail .controls { \" +\r\n\t\t\t\t\t\t\" left: 0px !important; right: 20px !important; \" +\r\n\t\t\t\t\t\t\" color: #818b98 !important; \" +\r\n\t\t\t\t\t\"}\" +\r\n\t\t\t\t\t\" .xkit-paper-cut-thingy {\" +\r\n\t\t\t\t\t\t\" display: none;\" +\r\n\t\t\t\t\t\" }\" +\r\n\t\t\t\t\t\" #posts .post.fan_mail .controls .controls_link { \" +\r\n\t\t\t\t\t\t\" color: #818b98 !important; \" +\r\n\t\t\t\t\t\" }\";\r\n\t\t\tXKit.tools.add_css(m_css, \"xkit_inbox_slim_fan_mail\");\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.mass_editor.value === true) {\r\n\t\t\tXKit.extensions.xinbox.init_mass_editor();\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.auto_expand_fan_mail.value === true) {\r\n\t\t\tvar au_ex_css = \".post.fan_mail .read_more, .post.fan_mail .message_body_truncated { display: none; } .post.fan_mail .message_body { display: block !important; }\";\r\n\t\t\tXKit.tools.add_css(au_ex_css, \"xkit_inbox_auto_expand\");\r\n\t\t}\r\n\r\n\t\tif(XKit.extensions.xinbox.preferences.inbox_search.value === true) {\r\n\t\t\tXKit.extensions.xinbox.init_inbox_search();\r\n\t\t}\r\n\r\n\t\t$(\"#xinbox_sidebar\").prepend(\"<li class=\\\"section_header selected\\\">INBOX TOOLS</li>\");\r\n\r\n\t},\r\n\r\n\tinbox_search_term: \"\",\r\n\r\n\ton_click_to_pa_reply: function(e) {\r\n\r\n\t\tvar m_post_id = $(e.target).attr('data-post-id');\r\n\r\n\t\tXKit.tools.add_function(function() {\r\n\r\n\t\t\tvar e_target = jQuery(\"#xinbox-reply-button-\" + add_tag);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tTumblr.DashboardAsk.open_ask(e_target);\r\n\t\t\t} catch(e){\r\n\t\t\t\tconsole.log(\"Error: \" + e.message);\r\n\t\t\t}\r\n\r\n\t\t}, true, m_post_id);\r\n\r\n\t},\r\n\r\n\tshow_reply_button: function() {\r\n\r\n\t\tif (XKit.installed.check(\"show_more\") !== true || XKit.installed.enabled(\"show_more\") !== true){ return; }\r\n\r\n\t\t$(\".post.is_private_answer\").not(\".xinbox-done-reply-button-on-pas\").each(function() {\r\n\r\n\t\t\t$(this).addClass(\"xinbox-done-reply-button-on-pas\");\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar tumblelog_name = \"\";\r\n\t\t\t\ttry {\r\n\t\t\t\t\ttumblelog_name = JSON.parse($(this).find(\".post_avatar_link\").attr('data-tumblelog-popover')).name;\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\t// Probably own ask.\r\n\t\t\t\t\ttumblelog_name = JSON.parse($(this).attr('data-json'))['tumblelog-name'];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tumblelog_name !== \"\" && typeof tumblelog_name !== \"undefined\") {\r\n\t\t\t\t\tXKit.interface.add_control_button($(this), \"xkit-xinbox-pa-reply\", \" data-tumblelog-name=\\\"\" + tumblelog_name + \"\\\" data-tumblelog-name=\\\"\" + tumblelog_name + \"\\\" id=\\\"xinbox-reply-button-\" + $(this).attr('data-post-id') + \"\\\" data-json=\\\"\" + $(this).find(\".post_avatar_link\").attr('data-tumblelog-popover') + \"\\\"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t} catch(e) {\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tinit_inbox_search: function() {\r\n\r\n\t\tvar m_html = '<li class=\"\" id=\"xinbox_search_li\" style=\"height: 36px;\">' +\r\n\t\t\t\t'<a href=\"#\" class=\"customize\" id=\"xinbox_search_button\">' +\r\n\t\t\t\t\t'<div class=\"hide_overflow\" style=\"color: rgba(255, 255, 255, 0.5) !important; font-weight: bold; padding-left: 10px; padding-top: 8px;\">Search Inbox..</div>' +\r\n\t\t\t\t'</a>' +\r\n\t\t\t\t'</li>';\r\n\r\n\t\tif ($(\"#xinbox_sidebar\").length > 0) {\r\n\r\n\t\t\t$(\"#xinbox_sidebar\").append(m_html);\r\n\r\n\t\t}\r\n\r\n\t\tvar x_html = \"<div id=\\\"xinbox-search-box\\\"><input type=\\\"text\\\" placeholder=\\\"Enter URL/text...\\\" id=\\\"xinbox-search-box-input\\\"></div>\";\r\n\t\t$(\"#xinbox_sidebar\").before(x_html);\r\n\r\n\t\t$(\"#xinbox_search_button\").bind(\"click\", function() {\r\n\r\n\t\t\tXKit.extensions.xinbox.inbox_search_start();\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xinbox-search-box-input\").keyup(function() {\r\n\r\n\t\t\tvar m_value = $(this).val().toLowerCase();\r\n\t\t\tm_value = $.trim(m_value);\r\n\r\n\t\t\tXKit.extensions.xinbox.inbox_search_term = m_value;\r\n\t\t\tXKit.extensions.xinbox.search_do_posts();\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tsearch_do_posts: function() {\r\n\t\tvar m_value = XKit.extensions.xinbox.inbox_search_term;\r\n\r\n\t\tfunction get_post_body(post) {\r\n\t\t\treturn post.find(\".post_body\").not(\".post_ask_answer_form_container\");\r\n\t\t}\r\n\r\n\t\tvar posts = $(\".post\");\r\n\r\n\t\tif (m_value === \"\" ||m_value.length <= 1) {\r\n\t\t\t// Show all\r\n\r\n\t\t\tget_post_body(posts).find(\"mark\").contents().unwrap();\r\n\r\n\t\t\tif ($(\"#xinbox-search-bar\").length > 0) {\r\n\t\t\t\t$(\"#xinbox-search-bar\").slideUp('slow', function() { $(this).remove(); });\r\n\t\t\t}\r\n\r\n\t\t\tposts.parent().removeClass(\"xkit-inbox-found\");\r\n\t\t\tposts.parent().slideDown('fast');\r\n\r\n\t\t\tXKit.tools.add_function(function() {\r\n\t\t\t\tTumblr.Events.trigger(\"DOMEventor:updateRect\");\r\n\t\t\t}, true, \"\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar i_html = \"Searching for <b>\\\"\" + m_value + \"\\\"</b><br/><span id=\\\"xinbox-search-found-count\\\">0</span> results found so far, inspected <span id=\\\"xinbox-search-search-count\\\">0</span> posts.<br/><small>Scroll down to load more asks and results.</small>\";\r\n\r\n\t\tif ($(\"#xinbox-search-bar\").length > 0) {\r\n\t\t\t$(\"#xinbox-search-bar\").html(i_html);\r\n\t\t} else {\r\n\t\t\t$(\"#posts\").before(\"<div id=\\\"xinbox-search-bar\\\">\" + i_html + \"</div>\");\r\n\t\t}\r\n\r\n\t\tposts.each(function() {\r\n\t\t\tvar post = $(this);\r\n\r\n\t\t\tvar username = post.attr('data-tumblelog-name');\r\n\t\t\tvar hide_this = false;\r\n\r\n\t\t\tvar to_search_in = post.find(\".post_body\").text().toLowerCase();\r\n\r\n\t\t\tif (typeof username !== \"undefined\") {\r\n\t\t\t\tto_search_in = to_search_in + username;\r\n\t\t\t}\r\n\r\n\t\t\tif (to_search_in.indexOf(m_value) === -1) {\r\n\t\t\t\thide_this = true;\r\n\t\t\t}\r\n\r\n\t\t\tvar post_body = get_post_body(post);\r\n\r\n\t\t\tif (!hide_this) {\r\n\t\t\t\tpost.parent().slideDown('fast');\r\n\t\t\t\tpost.parent().addClass(\"xkit-inbox-found\");\r\n\r\n\t\t\t\tpost_body.find(\"mark\").contents().unwrap();\r\n\t\t\t\tvar m_html = XKit.extensions.xinbox.return_highlighted_html(post_body.html(), m_value);\r\n\t\t\t\tpost_body.html(m_html);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tpost.parent().slideUp('fast');\r\n\t\t\t\tpost.parent().removeClass(\"xkit-inbox-found\");\r\n\t\t\t\tpost_body.find(\"mark\").contents().unwrap();\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xinbox-search-found-count\").html($(\".xkit-inbox-found\").length);\r\n\t\t$(\"#xinbox-search-search-count\").html($(\".post\").length);\r\n\r\n\t\tXKit.tools.add_function(function() {\r\n\t\t\tTumblr.Events.trigger(\"DOMEventor:updateRect\");\r\n\t\t}, true, \"\");\r\n\t},\r\n\r\n\tremove_wraps: function(src_str) {\r\n\r\n\t\tsrc_str = XKit.tools.replace_all(src_str, \"<wrap>\",\"\");\r\n\t\tsrc_str = XKit.tools.replace_all(src_str, \"<\\/wrap>\",\"\");\r\n\r\n\t\treturn src_str;\r\n\r\n\t},\r\n\r\n\treturn_highlighted_html: function(src_str, term) {\r\n\r\n\t\t/* from http://jsfiddle.net/UPs3V/ */\r\n\r\n\t\tterm = term.replace(/(\\s+)/,\"(<[^>]+>)*$1(<[^>]+>)*\");\r\n\t\tvar pattern = new RegExp(\"(\"+term+\")\", \"i\");\r\n\r\n\t\tsrc_str = src_str.replace(pattern, \"<mark>$1</mark>\");\r\n\t\tsrc_str = src_str.replace(/(<mark>[^<>]*)((<[^>]+>)+)([^<>]*<\\/mark>)/,\"$1</mark>$2<mark>$4\");\r\n\r\n\t\treturn src_str;\r\n\r\n\t},\r\n\r\n\tinbox_search_start: function() {\r\n\r\n\t\t$(\"#xinbox_search_button\").toggleClass(\"xkit-xinbox-in-search\");\r\n\t\tvar right_column_children = $(\"#right_column\").children().not(\"#xinbox_sidebar\").not(\"#xinbox-search-box\").not(\"script\");\r\n\r\n\t\tif ($(\"#xinbox_search_button\").hasClass(\"xkit-xinbox-in-search\")) {\r\n\r\n\t\t\t$(\"#xinbox_search_li\").addClass(\"selected\");\r\n\t\t\tXKit.extensions.xinbox.inbox_search_term = \"\";\r\n\r\n\t\t\t$(\".post\").parent().addClass(\"xkit-inbox-found\");\r\n\t\t\tXKit.tools.add_css(\".post_container { display: none; } .post_container.xkit-inbox-found { display: block; } \", \"xkit-inbox-search\");\r\n\t\t\tXKit.post_listener.add(\"xinbox_search\", XKit.extensions.xinbox.search_do_posts);\r\n\r\n\t\t\t$(\"#xinbox_sidebar\").addClass(\"xkit_others_hidden\");\r\n\t\t\tright_column_children.slideUp('slow', function() {\r\n\t\t\t\t$(this).addClass(\"xinbox-search-hidden-box\");\r\n\t\t\t});\r\n\t\t\t$(\"#xinbox-search-box\").slideDown('slow');\r\n\r\n\t\t} else {\r\n\r\n\t\t\t$(\"#xinbox_search_li\").removeClass(\"selected\");\r\n\t\t\tXKit.extensions.xinbox.inbox_search_term = \"\";\r\n\r\n\t\t\tXKit.extensions.xinbox.reset_search();\r\n\r\n\t\t\t$(\"#xinbox_sidebar\").removeClass(\"xkit_others_hidden\");\r\n\t\t\tright_column_children.slideDown('slow', function() {\r\n\t\t\t\t$(this).removeClass(\"xinbox-search-hidden-box\");\r\n\t\t\t});\r\n\t\t\t$(\"#xinbox-search-box\").slideUp('slow');\r\n\r\n\t\t}\r\n\t},\r\n\r\n\treset_search: function() {\r\n\r\n\t\t$(\".post\").parent().removeClass(\"xkit-inbox-found\");\r\n\t\tXKit.tools.remove_css(\"xkit-inbox-search\");\r\n\t\tXKit.post_listener.remove(\"xinbox_search\");\r\n\r\n\t\tif ($(\"#xinbox-search-bar\").length > 0) {\r\n\t\t\t$(\"#xinbox-search-bar\").slideUp('slow', function() { $(this).remove(); });\r\n\t\t}\r\n\r\n\t\t$(\".post\").find(\".post_body\").find(\"mark\").contents().unwrap();\r\n\r\n\t\tXKit.tools.add_function(function() {\r\n\t\t\tTumblr.Events.trigger(\"DOMEventor:updateRect\");\r\n\t\t}, true, \"\");\r\n\r\n\t\tif ($(\".post\").length > 30) {\r\n\t\t\t$(\".post:gt(30)\").remove();\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tauto_expand_fan_mail: function() {\r\n\r\n\t\ttry {\r\n\t\t\t$(\".fan_mail_read_more\").trigger('click');\r\n\t\t} catch(e) {\r\n\t\t\tXKit.console.add(\"auto_expand_fan_mail: \" + e.message);\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tinit_mass_editor: function() {\r\n\r\n\t\tif (XKit.interface.where().inbox !== true) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\txf_html = '<ul class=\"controls_section\" id=\"xinbox_sidebar\">' +\r\n\t\t\t'<li class=\"\" id=\"xinbox_mass_edit_li\" style=\"height: 36px;\">' +\r\n\t\t\t\t'<a href=\"#\" class=\"customize\" id=\"xinbox_mass_edit_button\">' +\r\n\t\t\t\t\t'<div class=\"hide_overflow\" style=\"color: rgba(255, 255, 255, 0.5) !important; font-weight: bold; padding-left: 10px; padding-top: 8px;\">Mass Edit Mode</div>' +\r\n\t\t\t\t'</a>' +\r\n\t\t\t'</li>' +\r\n\t\t\t'</ul>';\r\n\r\n\t\t$(\"ul.controls_section:eq(0)\").before(xf_html);\r\n\r\n\t\t$(\"#xinbox_mass_edit_button\").click(function() {\r\n\r\n\t\t\tif (!$(this).parent().hasClass(\"xkit-selected\")) {\r\n\r\n\t\t\t\t$(this).parent().addClass(\"xkit-selected\");\r\n\t\t\t\t$(this).parent().addClass(\"selected\");\r\n\t\t\t\tXKit.extensions.xinbox.start_mass_editor();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t$(this).parent().removeClass(\"xkit-selected\");\r\n\t\t\t\t$(this).parent().removeClass(\"selected\");\r\n\t\t\t\tXKit.extensions.xinbox.stop_mass_editor();\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tstop_mass_editor: function() {\r\n\r\n\t\tXKit.tools.remove_css(\"xinbox_mass_editor\");\r\n\t\t$(\"#xinbox_mass_text\").remove();\r\n\t\t$(document).off(\"click\", \".post\");\r\n\r\n\t},\r\n\r\n\tstart_mass_editor: function() {\r\n\r\n\r\n\t\tvar button_default = \"No messages selected\";\r\n\t\tvar button_selected = \"Delete %s Messages\";\r\n\t\tvar button_selected_first = \"Delete 1 Message\";\r\n\r\n\t\tXKit.tools.add_css(\" #posts { padding: 0; margin: 0 !important; } .xtimestamp { display: none; } .post_controls { display: none; }\" +\r\n\t\t\t\t\" .post:last-child { display: block; } #left_column { min-height: 120%; } \" +\r\n\t\t\t\t\" .post:active { position: relative; top: 1px; } \" +\r\n\t\t\t\t\" .post { -moz-user-select: none; user-select: none; -webkit-user-select: none; float: left !important; width: 200px !important; height: 150px !important; \" +\r\n\t\t\t\t\"    opacity: 0.53; \" +\r\n\t\t\t\t\"    display: inline-block !important; clear: none !important; overflow: hidden !important; \" +\r\n\t\t\t\t\"    margin: 0px 4px 8px 4px !important; } \" +\r\n\t\t\t\t\" .fan_mail { display: none !important; } \" +\r\n\t\t\t\t\" #xkit_delete_selected:hover { background: rgba(255,255,255,0.12); cursor: pointer; } \" +\r\n\t\t\t\t\" #xkit_delete_selected.disabled { opacity: 0.5; cursor: default; \" +\r\n\t\t\t\t\" background: rgba(255,255,255,0.08) !important; top: 0 !important; } \" +\r\n\t\t\t\t\" #xkit_delete_selected:active { background: rgba(0,0,0,0.12); \" +\r\n\t\t\t\t\" box-shadow: inset 0px 1px 2px rgba(0,0,0,0.43); position: relative; top: 1px; } \" +\r\n\t\t\t\t\" #xkit_delete_selected { border: 1px solid rgba(0,0,0,0.32); border-radius: 6px; \" +\r\n\t\t\t\t\" box-shadow: inset 0px 1px 0px rgba(255,255,255,0.12), 0px 1px 0px rgba(255,255,255,0.12); \" +\r\n\t\t\t\t\" padding: 5px 15px; background: rgba(255,255,255,0.08); display: inline-block; margin-top: 5px;} \" +\r\n\t\t\t\t\" .post a { pointer-events: none; cursor: default; } \" +\r\n\t\t\t\t\" .post.xpost-selected { opacity: 1; } \" +\r\n\t\t\t\t\" .post.xpost-working { animation: xpost-working-ani 1s infinite; \" +\r\n\t\t\t\t\" -webkit-animation: xpost-working-ani 1s infinite; \" +\r\n\t\t\t\t\" -webkit-animation: xpost-working-ani 1s infinite; } \" +\r\n\t\t\t\t\" @-moz-keyframes xpost-working-ani { from { opacity: 1; } 50% { opacity: 0.32; } to { opacity: 1; } } \" +\r\n\t\t\t\t\" @-webkit-keyframes xpost-working-ani { from { opacity: 1; } 50% { opacity: 0.32; } to { opacity: 1; } } \", \"xinbox_mass_editor\");\r\n\r\n\t\t$(\"#left_column\").prepend(\"<div class=\\\"dashboard_options_form\\\" id=\\\"xinbox_mass_text\\\">\" +\r\n\t\t\t\t\"<b>Welcome to Mass Edit Mode.</b><br/>\" +\r\n\t\t\t\t\"Select the messages you want deleted and click the button below.\" +\r\n\t\t\t\t\"<div style=\\\"margin-top: 8px;\\\">\" +\r\n\t\t\t\t\"<div id=\\\"xkit_delete_selected\\\" class=\\\"disabled\\\">No messages selected</div>\" +\r\n\t\t\t\t\"</div></div>\");\r\n\r\n\t\tXKit.tools.add_function(function() {\r\n\t\t\tTumblr.Events.trigger(\"DOMEventor:updateRect\");\r\n\t\t}, true, \"\");\r\n\r\n\t\t$(\"#xkit_delete_selected\").click(function() {\r\n\r\n\t\t\tif ($(this).hasClass(\"disabled\") === true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$(this).addClass(\"disabled\");\r\n\r\n\t\t\tvar msg_count = 0;\r\n\t\t\t$(\".xpost-selected\").each(function() {\r\n\t\t\t\tmsg_count++;\r\n\t\t\t});\r\n\r\n\t\t\tXKit.extensions.xinbox.delete_msg_count = msg_count;\r\n\t\t\tXKit.extensions.xinbox.delete_msg_index = 0;\r\n\t\t\tXKit.extensions.xinbox.mass_editor_working = true;\r\n\r\n\t\t\tvar m_html = $(\"body\").html();\r\n\t\t\tvar m_key_start = m_html.indexOf(\"key = '\", m_html.indexOf(\"deny_post(\")) + 7;\r\n\t\t\tvar m_key_end = m_html.indexOf(\"';\", m_key_start);\r\n\t\t\tvar m_key = m_html.substring(m_key_start, m_key_end);\r\n\r\n\t\t\tXKit.extensions.xinbox.delete_key = m_key;\r\n\t\t\tXKit.extensions.xinbox.mass_editor_delete();\r\n\r\n\t\t});\r\n\r\n\t\t$(document).on(\"click\", \".post\", function(event) {\r\n\t\t\tif (XKit.extensions.xinbox.mass_editor_working === true) { return; }\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif ($(this).hasClass(\"xpost-selected\") === true) {\r\n\t\t\t\tXKit.extensions.xinbox.selected_post_count = XKit.extensions.xinbox.selected_post_count - 1;\r\n\t\t\t} else {\r\n\t\t\t\tXKit.extensions.xinbox.selected_post_count++;\r\n\t\t\t}\r\n\t\t\t$(this).toggleClass(\"xpost-selected\");\r\n\t\t\tif (XKit.extensions.xinbox.selected_post_count === 0) {\r\n\t\t\t\t$(\"#xkit_delete_selected\").html(button_default);\r\n\t\t\t\t$(\"#xkit_delete_selected\").addClass(\"disabled\");\r\n\t\t\t} else {\r\n\t\t\t\t// English is a weird language, innit?\r\n\t\t\t\t$(\"#xkit_delete_selected\").removeClass(\"disabled\");\r\n\t\t\t\tif (XKit.extensions.xinbox.selected_post_count === 1) {\r\n\t\t\t\t\t$(\"#xkit_delete_selected\").html(button_selected_first);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#xkit_delete_selected\").html(button_selected.replace(\"%s\", XKit.extensions.xinbox.selected_post_count));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t},\r\n\r\n\tselected_post_count: 0,\r\n\tmass_editor_working: false,\r\n\tdelete_msg_index: 0,\r\n\tdelete_msg_count: 0,\r\n\tdelete_key: \"\",\r\n\r\n\tmass_editor_delete: function() {\r\n\r\n\t\tvar button_working = \"Deleting message %s of %m\";\r\n\t\tvar current_msg = XKit.extensions.xinbox.delete_msg_index + 1;\r\n\t\tvar msg_count = XKit.extensions.xinbox.delete_msg_count;\r\n\r\n\t\tvar button_default = \"No messages selected\";\r\n\r\n\t\tif (current_msg > msg_count) {\r\n\t\t\tselected_post_count = 0;\r\n\t\t\tXKit.window.show(\"Done!\",\"All messages deleted successfully.\",\"info\",\"<div id=\\\"xkit-close-message\\\" class=\\\"xkit-button default\\\">OK</div>\");\r\n\t\t\t$(\"#xkit_delete_selected\").html(button_default);\r\n\t\t\t$(\"#xkit_delete_selected\").addClass(\"disabled\");\r\n\t\t\tXKit.extensions.xinbox.mass_editor_working = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar m_key = XKit.extensions.xinbox.delete_key;\r\n\t\t$(\"#xkit_delete_selected\").html(button_working.replace(\"%m\", msg_count).replace(\"%s\", current_msg));\r\n\r\n\t\t$(\".xpost-selected:eq(0)\").addClass(\"xpost-working\");\r\n\t\tvar m_id = $(\".xpost-selected:eq(0)\").attr('id').replace(\"post_\",\"\");\r\n\r\n\t\tsetTimeout(function() {\r\n\r\n\t\tGM_xmlhttpRequest({\r\n\t\t\tmethod: \"POST\",\r\n\t\t\turl: \"http://www.tumblr.com/deny_submission/\",\r\n\t\t\tdata: \"form_key=\" + m_key + \"&pid=\" + m_id,\r\n\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\"\r\n\t\t\t},\r\n\t\t\tonerror: function(response) {\r\n\t\t\t\talert(\"XInbox can not fetch the required page:\\n\\n\" +\r\n\t\t\t\t\"There might be a connection problem, or the extension might need updating.\\n\\n\" +\r\n\t\t\t\t\"Please try again later, and if the problem continues, disable XInbox from \\n\" +\r\n\t\t\t\t\"the XKit Control Panel (X icon > XInbox > Disable this Extension) to answer\\n\" +\r\n\t\t\t\t\"your asks while this problem is being fixed.\");\r\n\t\t\t},\r\n\t\t\tonload: function(response) {\r\n\t\t\t\tXKit.extensions.xinbox.delete_msg_index = current_msg;\r\n\t\t\t\tvar post_div = $(\".xpost-selected:eq(0)\");\r\n\t\t\t\t$(post_div).fadeOut('fast', function() { $(this).parent().remove(); });\r\n\t\t\t\tsetTimeout(function() { XKit.extensions.xinbox.mass_editor_delete(); }, 500);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t}, 700);\r\n\r\n\t},\r\n\r\n\tresize_text_area: function(post_id) {\r\n\r\n\t\tif ($(\"#ask_answer_field_\" + (+post_id) + \"_tbl\").length > 0) {\r\n\r\n\t\t\t$(\"#ask_answer_field_\" + (+post_id) + \"_tbl, #ask_answer_field_\" + post_id + \"_ifr\").css(\"height\",\"220px\");\r\n\r\n\t\t} else {\r\n\r\n\t\t\tsetTimeout(function() { XKit.extensions.xinbox.resize_text_area(post_id); }, 100);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tinit_tags: function() {\r\n\r\n\t\ttry {\r\n\r\n\t\t\t$(\"[id^='ask_answer_link_']\").unbind(\"click\");\r\n\r\n\t\t\t$(\"[id^='ask_answer_link_']\").bind(\"click\", function() {\r\n\r\n\t\t\t\tvar m_parent = $(this).parentsUntil(\".post\").parent();\r\n\t\t\t\tvar post_id = $(m_parent).attr('id').replace(\"post_\",\"\");\r\n\r\n\t\t\t\t// Make it longer?\r\n\t\t\t\tif(XKit.extensions.xinbox.preferences.bigger_answer_boxes.value === true) {\r\n\t\t\t\t\tXKit.extensions.xinbox.resize_text_area(post_id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($(m_parent).find(\".xkit-xinbox-button-publish\").length > 0)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t// Disable default buttons.\r\n\t\t\t\tvar submit_button = $(m_parent).find('[id^=\"ask_publish_button_\"]');\r\n\t\t\t\t$(submit_button).attr('onclick','return false;');\r\n\t\t\t\t$(submit_button).attr('data-state','0');\r\n\r\n\t\t\t\tvar queue_button = $(m_parent).find('[id^=\"ask_queue_button_\"]');\r\n\t\t\t\t$(queue_button).attr('onclick','return false;');\r\n\t\t\t\t$(queue_button).attr('data-state','2');\r\n\r\n\t\t\t\tvar draft_button = $(m_parent).find('[id^=\"ask_draft_button_\"]');\r\n\t\t\t\t$(draft_button).attr('onclick','return false;');\r\n\t\t\t\t$(draft_button).attr('data-state','1');\r\n\r\n\t\t\t\tvar this_obj = m_parent;\r\n\t\t\t\tvar m_box_id = \"xinbox_tags_\" + post_id;\r\n\r\n\r\n\t\t\t\tvar asker = XKit.extensions.xinbox.preferences.anon_tag.value;\r\n\t\t\t\tvar respondant = $(m_parent).attr('data-tumblelog-name');\r\n\t\t\t\tif (m_parent.find(\".post_info\").find(\"a\").length > 0) {\r\n\t\t\t\t\tasker = m_parent.find(\".post_info\").find(\"a\").html();\r\n\r\n\t\t\t\t\t// If the ask is anonymous there is no link to their blog to parse.\r\n\t\t\t\t\t// If the blog is secondary there will be a link to respondant's own blog\r\n\t\t\t\t\t// and this will be found instead. Reset asker to anoymous if this is the case.\r\n\t\t\t\t\tif(asker === respondant){\r\n\t\t\t\t\t\tasker = XKit.extensions.xinbox.preferences.anon_tag.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t/*\r\n\r\n\t\t\t\tOBSOLETE -- Tumblr changes.\r\n\r\n\t\t\t\t*/\r\n\r\n\t\t\t\t/*var asker = XKit.extensions.xinbox.preferences.anon_tag.value;\r\n\t\t\t\tvar respondant = $(m_parent).attr('data-tumblelog-name');\r\n\r\n\t\t\t\tif (respondant !== \"\" && typeof respondant !== \"undefined\" && !m_parent.hasClass(\"post_tumblelog_\")) {\r\n\t\t\t\t\tasker = respondant;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (typeof asker === \"undefined\") {\r\n\t\t\t\t\t\tasker = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}*/\r\n\r\n\t\t\t\t/* var asker = \"\";\r\n\r\n\t\t\t\tif ($(m_parent).find(\".post_avatar_link\").length > 0) {\r\n\r\n\t\t\t\t\tvar avatar_json_data = $(m_parent).find(\".post_avatar_link\").attr('data-tumblelog-popover');\r\n\t\t\t\t\tif (avatar_json_data !== \"\" && typeof avatar_json_data !== \"undefined\") {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tvar avatar_json = JSON.parse(avatar_json_data);\r\n\t\t\t\t\t\t\tif (avatar_json.name !== \"\" && typeof avatar_json.name !== \"undefined\") {\r\n\t\t\t\t\t\t\t\tasker = avatar_json.name;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}catch(e) {\r\n\t\t\t\t\t\t\tXKit.console.add(\"Can't tag ask ---->\" + e.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tXKit.console.add(\"xinbox tagger -> data-tumblelog-popover data missing\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tXKit.console.add(\"xinbox tagger -> post_avatar_link missing\");\r\n\t\t\t\t}*/\r\n\r\n\t\t\t\t// return alert(\"asker = \" + asker);\r\n\r\n\t\t\t\tvar all_buttons = $(m_parent).find('[id^=\"ask_publish_button_\"], [id^=\"ask_draft_button_\"], [id^=\"ask_queue_button_\"]');\r\n\t\t\t\tvar private_button = $(m_parent).find('[id^=\"private_answer_button_\"]');\r\n\r\n\t\t\t\t$(all_buttons).remove();\r\n\r\n\t\t\t\tvar publish_button_div = \"<button class=\\\"chrome blue xkit-xinbox-button xkit-xinbox-button-publish\\\" data-state=\\\"0\\\" data-post-id=\\\"\" + $(m_parent).attr('data-post-id') + \"\\\">Publish</button>\";\r\n\r\n\t\t\t\tif (private_button.length > 0) {\r\n\t\t\t\t\t$(private_button).css(\"margin-left\",\"2px\");\r\n\t\t\t\t\t$(private_button).before(publish_button_div);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(m_parent).find(\".ask_cancel_button\").parent().append(publish_button_div);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar other_buttons_div = \"<button class=\\\"chrome xkit-xinbox-button xkit-xinbox-button-draft xkit-xinbox-button-hidden\\\" data-state=\\\"1\\\" data-post-id=\\\"\" + $(m_parent).attr('data-post-id') + \"\\\">Save as Draft</div>\" +\r\n\t\t\t\t\t\t\t\"<button class=\\\"chrome xkit-xinbox-button xkit-xinbox-button-queue xkit-xinbox-button-hidden\\\" data-state=\\\"2\\\" data-post-id=\\\"\" + $(m_parent).attr('data-post-id') + \"\\\">Queue</div>\";\r\n\r\n\t\t\t\tif (private_button.length > 0) {\r\n\t\t\t\t\t$(private_button).after(other_buttons_div);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(m_parent).find(\".ask_cancel_button\").parent().append(other_buttons_div);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tall_buttons = $(m_parent).find('.xkit-xinbox-button');\r\n\r\n\t\t\t\t$(all_buttons).attr('onclick','');\r\n\t\t\t\t$(all_buttons).bind(\"click\",function(event) {\r\n\r\n\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\t$(all_buttons).attr('disabled','disabled');\r\n\r\n\t\t\t\t\tvar m_tags = \"\";\r\n\r\n\t\t\t\t\tif ($(\"#\" + m_box_id).length > 0) {\r\n\t\t\t\t\t\tm_tags = $(\"#\" + m_box_id).val();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (XKit.extensions.xinbox.preferences.tag_usernames_replace_hyphens.value === true) {\r\n\t\t\t\t\t\tasker = asker.replace(/-/g, ' ');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(XKit.extensions.xinbox.preferences.tag_usernames.value === true) {\r\n\t\t\t\t\t\tif (m_tags === \"\") {\r\n\t\t\t\t\t\t\tm_tags = asker;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tm_tags = m_tags + \",\" + asker;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(XKit.extensions.xinbox.preferences.tag_custom.value === true) {\r\n\t\t\t\t\t\tif (XKit.extensions.xinbox.preferences.custom_tag.value !== \"\") {\r\n\t\t\t\t\t\t\tif (m_tags === \"\") {\r\n\t\t\t\t\t\t\t\tm_tags = XKit.extensions.xinbox.preferences.custom_tag.value;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tm_tags = m_tags + \",\" + XKit.extensions.xinbox.preferences.custom_tag.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar m_state = $(this).attr('data-state');\r\n\t\t\t\t\tif (typeof m_state === \"undefined\") {\r\n\t\t\t\t\t\tm_state = \"0\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tXKit.extensions.xinbox.poke_tinymce(post_id);\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tXKit.extensions.xinbox.publish_ask(this_obj, post_id, m_tags, m_state);\r\n\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(m_parent).find(\".xinbox_tag_box\").remove();\r\n\r\n\t\t\t\t// Does the user want the tag box?\r\n\r\n\t\t\t\tif (XKit.extensions.xinbox.preferences.show_tag_box.value === true) {\r\n\r\n\t\t\t\t\t// Calculate tag box width.\r\n\t\t\t\t\t$(m_parent).find(\".ask_cancel_button\").parent().css(\"padding-top\",\"0\");\r\n\r\n\t\t\t\t\t// Add our tag box here.\r\n\r\n\t\t\t\t\tvar m_html = '<div class=\"xinbox_tag_box\">' +\r\n\t\t\t\t\t\t\t'<input class=\"xinbox_tag_box_input\" id=\"' + m_box_id + '\" ' +\r\n\t\t\t\t\t\t\t\t' placeholder=\"Tags, comma separated\" />' +\r\n\t\t\t\t\t\t\t'</div>';\r\n\r\n\r\n\t\t\t\t\t$(m_parent).find(\".ask_cancel_button\").parent().prepend(m_html);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t} catch(e) {\r\n\t\t\tXKit.notifications.add(\"<b>Can't run \" + this.title + \":</b><br/>\" + e.message, \"error\");\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tpublish_ask: function(post_div, post_id, tags, state) {\r\n\r\n\t\tXKit.extensions.xinbox.poke_tinymce(post_id);\r\n\r\n\t\tvar answer = $('#ask_answer_field_' + post_id).val();\r\n\r\n\t\tif (answer === \"\" && XKit.extensions.xinbox.preferences.check_for_blanks.value === true) {\r\n\t\t\t// Check if the user really wants to post this.\r\n\t\t\tif (!confirm(\"XInbox is curious:\\nYou didn't enter an answer. Send it anyway?\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar load_box = $('#post_control_loader_' + post_id);\r\n\r\n\t\t$(post_div).find('.xinbox_tag_box_input').attr('disabled','disabled');\r\n\t\t$(post_div).find('[id^=\"ask_publish_button_\"]').attr('disabled','disabled');\r\n\t\t$(post_div).find('[id^=\"ask_cancel_button_\"]').attr('disabled','disabled');\r\n\t\t$(post_div).find('[id^=\"ask_queue_button_\"]').attr('disabled','disabled');\r\n\t\t$(post_div).find('[id^=\"ask_draft_button_\"]').attr('disabled','disabled');\r\n\t\t$(post_div).find('[id^=\"private_answer_button_\"]').attr('disabled','disabled');\r\n\t\t$(load_box).css(\"display\",\"block\");\r\n\r\n\t\tvar form_key = $('meta[name=tumblr-form-key]').attr(\"content\");\r\n\r\n\t\tvar m_object = {};\r\n\r\n\t\tm_object.post_id = parseInt(post_id);\r\n\t\tm_object.form_key = form_key;\r\n\t\tm_object.post_type = false;\r\n\r\n\t\tGM_xmlhttpRequest({\r\n\t\t\tmethod: \"POST\",\r\n\t\t\turl: \"http://www.tumblr.com/svc/post/fetch\",\r\n\t\t\tdata: JSON.stringify(m_object),\r\n\t\t\tjson: true,\r\n\t\t\tonerror: function(response) {\r\n\t\t\t\tXKit.extensions.xinbox.show_error(\"I was unable to reach Tumblr servers, or the server returned an error.\");\r\n\t\t\t\treturn;\r\n\t\t\t},\r\n\t\t\tonload: function(response) {\r\n\t\t\t\t// We are done!\r\n\t\t\t\tvar mdata = null;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tmdata = $.parseJSON(response.responseText);\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\tXKit.extensions.xinbox.show_error(\"Server returned a non-JSON object. Maybe server overloaded, try again later. Error: \" + e.message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (mdata.errors === false) {\r\n\t\t\t\t\tXKit.extensions.xinbox.send_publish_request(mdata, answer, tags, post_div, form_key, post_id, state);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tXKit.extensions.xinbox.show_error(\"Server returned an error message. Maybe you hit your post limit or your account was suspended.\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tsend_publish_request: function(mdata, answer, tags, post_div, form_key, post_id, state, retry_mode) {\r\n\r\n\t\tvar m_object = {};\r\n\r\n\t\tm_object.form_key = form_key;\r\n\t\tm_object.channel_id = mdata.post_tumblelog.name_or_id;\r\n\r\n\t\tm_object.post_id = post_id;\r\n\t\tm_object.edit = false;\r\n\t\tm_object.detached = true;\r\n\t\tm_object.errors = false;\r\n\t\tm_object.created_post = false;\r\n\t\tm_object.context_page = \"dashboard\";\r\n\t\tm_object.post_context_page = \"dashboard\";\r\n\t\tm_object.silent = false;\r\n\t\tm_object.context_id = \"\";\r\n\t\tif ($(\".editor_note a\").length > 0) {\r\n\t\tm_object.editor_type = \"markdown\";\r\n\t\t} else {\r\n\t\tm_object.editor_type = \"rich\";\r\n\t\t}\r\n\r\n\t\tm_object[\"is_rich_text[one]\"] = \"0\";\r\n\t\tm_object[\"is_rich_text[two]\"] = \"1\";\r\n\t\tm_object[\"is_rich_text[three]\"] = \"0\";\r\n\r\n\t\tm_object[\"post[type]\"] = \"note\";\r\n\t\tm_object[\"post[slug]\"] = \"\";\r\n\t\tm_object[\"post[date]\"] = \"\";\r\n\r\n\t\tm_object[\"post[two]\"] = answer;\r\n\t\tm_object[\"post[tags]\"] = \",\" + tags;\r\n\t\tm_object[\"post[publish_on]\"] = \"\";\r\n\t\tm_object[\"post[state]\"] = state;\r\n\r\n\t\tXKit.interface.kitty.get(function(kitty_data) {\r\n\r\n\t\t\tif (kitty_data.errors === true) {\r\n\r\n\t\t\t\t// We fucked up. Let's try again.\r\n\t\t\t\tif (retry_mode === false) {\r\n\t\t\t\t\tXKit.extensions.xinbox.send_publish_request(mdata, answer, tags, post_div, form_key, post_id, state, true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tXKit.extensions.xinbox.show_error(\"Could not authorize post request.\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tGM_xmlhttpRequest({\r\n\t\t\t\tmethod: \"POST\",\r\n\t\t\t\turl: \"http://www.tumblr.com/svc/post/update\",\r\n\t\t\t\tdata: JSON.stringify(m_object),\r\n\t\t\t\tjson: true,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"X-tumblr-puppies\": kitty_data.kitten,\r\n\t\t\t\t\t\"X-tumblr-form-key\": XKit.interface.form_key(),\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function(response) {\r\n\t\t\t\t\tXKit.extensions.xinbox.show_error(\"I was unable to reach Tumblr servers, or the server returned an error.\");\r\n\t\t\t\t},\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\t// We are done!\r\n\t\t\t\t\tXKit.interface.kitty.set(response.getResponseHeader(\"X-tumblr-kittens\"));\r\n\t\t\t\t\tvar mdata = null;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tmdata = $.parseJSON(response.responseText);\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\tXKit.extensions.xinbox.show_error(\"Server returned a non-JSON object. Maybe server overloaded, try again later. Error: \" + e.message);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (mdata.errors === false) {\r\n\t\t\t\t\t\t$(post_div).fadeOut('slow', function() {\r\n\t\t\t\t\t\t\t$(post_div).parent().remove();\r\n\t\t\t\t\t\t\tXKit.tools.add_function(function() {\r\n\t\t\t\t\t\t\t\tTumblr.Events.trigger(\"DOMEventor:updateRect\");\r\n\t\t\t\t\t\t\t}, true, \"\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (state === \"\" ||state === \"0\") { XKit.notifications.add(\"Published ask.\",\"ok\"); }\r\n\t\t\t\t\t\tif (state === \"1\") { XKit.notifications.add(\"Drafted ask.\",\"ok\"); }\r\n\t\t\t\t\t\tif (state === \"2\") { XKit.notifications.add(\"Queued ask.\",\"ok\"); }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tXKit.extensions.xinbox.show_error(\"Server returned an error message. Maybe you hit your post limit or your account was suspended.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tshow_error: function(msg) {\r\n\r\n\t\tXKit.window.show(\"Can't publish ask\",\"Something went wrong and prevented XKit from publishing this ask. You might want to disable XInbox (or at least the tagging options of XInbox) if this is related to a recent Tumblr change.<br/><p>\" + msg + \"</p>Try refreshing the page and trying again, or disable XInbox extension and file a bug report.\", \"error\", \"<div id=\\\"xkit-close-message\\\" class=\\\"xkit-button default\\\">OK</div>\");\r\n\r\n\t},\r\n\r\n\tpoke_tinymce: function(post_id) {\r\n\t\tsource = \" if (tinyMCE && tinyMCE.get('ask_answer_field_\" + post_id + \"')) {  \" +\r\n\t\t\t\t\t\t\" document.getElementById('ask_answer_field_\" + post_id + \"').value = (tinyMCE.get('ask_answer_field_\" + post_id + \"').getContent()); \" +\r\n\t\t\t\t\t\t\" } \";\r\n\r\n\t\tif ('function' == typeof source) {\r\n\t\t\t\tsource = '(' + source + ')();';\r\n\t\t}\r\n\r\n\t\tvar script = document.createElement('script');\r\n\t\tscript.setAttribute(\"type\", \"application/javascript\");\r\n\t\tscript.textContent = source;\r\n\t\tdocument.body.appendChild(script);\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\t$(\"#xinbox_sidebar\").remove();\r\n\t\tXKit.post_listener.remove(\"xinbox_auto_expand_fan_mail\");\r\n\t\tXKit.post_listener.remove(\"xinbox_search\");\r\n\t\tXKit.post_listener.remove(\"xinbox_show_reply_buttons\");\r\n\t\t$(document).off(\"click\", \"[id^='ask_answer_link_']\");\r\n\t\tclearInterval(XKit.extensions.xinbox.notification_check_interval);\r\n\t\tXKit.tools.remove_css(\"xkit_inbox_slim_fan_mail\");\r\n\t\tXKit.tools.remove_css(\"xkit_inbox_auto_expand\");\r\n\t\tXKit.tools.remove_css(\"xkit_inbox_show_queue\");\r\n\t\tXKit.tools.remove_css(\"xinbox_slim_outgoing_fan_mail\");\r\n\t\tXKit.tools.remove_css(\"xkit_inbox_hide_fan_mail_button\");\r\n\t\tXKit.tools.remove_css(\"xinbox\");\r\n\t\tthis.running = false;\r\n\t}\r\n\r\n});\r\n","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGNzdGMTE3NDA3MjA2ODExODA4MzkyMjM2MzU5MTQ4NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1NjZGMDIwODNBRDUxMUUzOEU0MkZBNUQ5QjU5M0FBOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NjZGMDIwNzNBRDUxMUUzOEU0MkZBNUQ5QjU5M0FBOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAxODAxMTc0MDcyMDY4MTFBRTczREVDNEM5OEM0RTE5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY3N0YxMTc0MDcyMDY4MTE4MDgzOTIyMzYzNTkxNDg0Ii8+IDwvcmRmOkRlc2NyaXB0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","css":".xinbox_tag_box {\r\n\tdisplay: block; height: 30px; margin-bottom: 15px !important;\r\n}\r\n\r\n.xkit-xinbox-button {\r\n\tfloat: left;\r\n\tmargin-left: 2px;\r\n\tdisplay: block;\r\n}\r\n\r\n.xinbox_tag_box_input {\r\n\tfloat: left; width: 100%;\r\n\t-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;\r\n\tpadding: 0px 8px 0px 30px; height: 38px; line-height: 17px; font-size: 12px;\r\n\tborder: 2px solid rgb(230,230,230); border-radius: 0px 0px 4px 4px; border-top: 0px;\r\n\tbackground-repeat: no-repeat; background-position: 10px 50%;\r\n\tbackground-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUE4NkI0NjU1MTA1MTFFMjkyRjE5MEM1NDM3RjRGMjMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUE4NkI0NjY1MTA1MTFFMjkyRjE5MEM1NDM3RjRGMjMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1QTg2QjQ2MzUxMDUxMUUyOTJGMTkwQzU0MzdGNEYyMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QTg2QjQ2NDUxMDUxMUUyOTJGMTkwQzU0MzdGNEYyMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pg0FWAAAAABySURBVHjajJLBDcAgCEXByTqKvbgTXuoobkZTaxsUInJSw/M/iUhEDLpKSuk0ziHIJrGOOedrBdR+Y/UgFEpP8+HpSSWrWSWFyR08CJkZ+iZugKUpdcedpDfhKyepPX4AFtA/KQUY0DBWExAQzF/kFmAASPRCZDEgzSkAAAAASUVORK5CYII=);\r\n}\r\n\r\n#xinbox_search_button:after {\r\n\r\n\tbackground-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDRBQkU4RjMzNkU2MTFFM0E0MTFDNDE2OTFDMzA4QzciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDRBQkU4RjQzNkU2MTFFM0E0MTFDNDE2OTFDMzA4QzciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNEFCRThGMTM2RTYxMUUzQTQxMUM0MTY5MUMzMDhDNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowNEFCRThGMjM2RTYxMUUzQTQxMUM0MTY5MUMzMDhDNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuSNlSQAAAEbSURBVHjaYvz//z8DNQETDvEcIL4PxK+B+D0Q3wJiL2IMZERzoSYQX8Oj/hsQ8wDxf2IM1AbiK0hyZ4B4GRCzQF0sh6wPp5UgA6EYGQgjicOwFZL8OyzyYAxj5CMpFsGlGIhDkNS54DPwIVTRGTyGwfBzqNq52ORhscwFpZcSEZEXoDQPvmTDQjCwMQEzPgPfQulCIgxygtIf8MWyB1JgW+IJvxIkddL4IgU92QRjUVyMJP8Fl6XoOQWZ8xSIrwLxPyC2B2JONM+dBmIzfAkbhJmA+PV/3ABd7hwhF8KAOxAHATEfELMB8XMgboXSJ4DYHKdLiUjI2PAZNJdeR0/YpAITaOEBA/dwFV+kgttQ7EUtA4kusckGAAEGAGOJAD0xp7muAAAAAElFTkSuQmCC');\r\n\tcontent: \"A\";\r\n\tfont-size: 0;\r\n\twidth: 24px;\r\n\tbackground-repeat: no-repeat;\r\n\tbackground-position: 3px 7px;\r\n\topacity: 0.42;\r\n\r\n}\r\n\r\n#xinbox_search_button.xkit-xinbox-in-search:after{ opacity: 1 !important; }\r\n\r\n\r\n#xinbox_mass_edit_button:after {\r\n\r\n\tbackground-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODhENjIzOEUzNkU3MTFFM0E0MTFDNDE2OTFDMzA4QzciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODhENjIzOEYzNkU3MTFFM0E0MTFDNDE2OTFDMzA4QzciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNEFCRThGNTM2RTYxMUUzQTQxMUM0MTY5MUMzMDhDNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowNEFCRThGNjM2RTYxMUUzQTQxMUM0MTY5MUMzMDhDNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlQr44YAAAA6SURBVHjaYvz//z8DNQETA5UBCxBjcyIjlCZZjuouHPwGsiCFCQOe8CJabjSWR2N5NJZHYxkrAAgwALHmDDo8kKZUAAAAAElFTkSuQmCC);\r\n\tcontent: \"A\";\r\n\tfont-size: 0;\r\n\twidth: 24px;\r\n\tbackground-repeat: no-repeat;\r\n\tbackground-position: 3px 7px;\r\n\topacity: 0.42;\r\n\r\n}\r\n\r\n.selected #xinbox_mass_edit_button:after{ opacity: 1 !important; }\r\n\r\n.ask_queue_button,\r\n.ask_draft_button,\r\n.private_answer_button,\r\n.ask_publish_button {\r\n\tfloat: left;\r\n}\r\n\r\n.xinbox_tag_box_input.xinbox_long_tag_box {\r\n\twidth: 255px;\r\n}\r\n\r\n.xinbox_tag_box_input::-webkit-input-placeholder { color: #999 !important; } .xinbox_tag_box_input:-moz-placeholder { color: #999 !important; } .xinbox_tag_box_input::-moz-placeholder { color: #999 !important; }\r\n\r\n.xinbox_tag_box_input:focus {\r\n\tbackground-color: rgb(245,245,245);\r\n\tcolor: black;\r\n}\r\n\r\n#xinbox-search-bar {\r\n\tbackground: rgba(0,0,0,0.12);\r\n\tborder: 1px solid rgba(0,0,0,0.22);\r\n\tcolor: rgba(255,255,255,0.53);\r\n\tpadding: 10px 14px;\r\n\tborder-radius: 6px;\r\n\tmargin-bottom: 15px;\r\n}\r\n\r\n#xinbox-search-box {\r\n\twidth: 100%;\r\n}\r\n\r\n#xinbox-search-box-input::-webkit-input-placeholder { /* WebKit browsers */\r\n    color:    #999;\r\n}\r\n#xinbox-search-box-input:-moz-placeholder { /* Mozilla Firefox 4 to 18 */\r\n    color:    #999;\r\n}\r\n\r\n#xinbox-search-box-input {\r\n\twidth: 100%;\r\n\tborder-radius: 3px;\r\n\tborder: 0px;\r\n\tpadding: 5px 10px 5px 30px;\r\n\tmargin-top: 0px;\r\n\tmargin-right: 5px;\r\n\tmargin-bottom: 0;\r\n\tmargin-left: 0px;\r\n\tfont-size: 15px;\r\n\tbox-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n\t-o-box-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\tbackground: white 10px 50% no-repeat url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjMxRTZFMEZBODY4MTFFMkFDMDJFMzk3N0RDMDc2NDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjMxRTZFMTBBODY4MTFFMkFDMDJFMzk3N0RDMDc2NDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzFFNkUwREE4NjgxMUUyQUMwMkUzOTc3REMwNzY0NCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzFFNkUwRUE4NjgxMUUyQUMwMkUzOTc3REMwNzY0NCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnjwe50AAADhSURBVHjalJExEoIwEEVDvAAdpUeQhhk7OQKeAO2k4wh6AztK4w04AvYUUNp5BDwB/sz8MGsGh/HP/MmyyctulmAcR2VVVdUOSwnHcAg38LUoiofyFFgIQI7YqHkZgEeZWEVRZCvU8ACfcGCfJMmlbVtbKYO3iDvkng7SbMmqBHB3G2wr4+dZVtJ8g5KAB3bujIRC9ac0p+Sm9yXkNqzy8iE3tVqCiNdiz8yN/Ib4wFzHVb7DTjbFG/sJ4s25+LmKLRnmQglO0C/xXY0AY700KbaUErDVh8VK3mAGXPL+CDAAWp9eZGKACQQAAAAASUVORK5CYII=') !important;\r\n}\r\n\r\n#xinbox_sidebar.xkit_others_hidden {\r\n\r\n}\r\n\r\n#xinbox-search-box { display: none; }","title":"XInbox","description":"Enhances your Inbox experience","developer":"STUDIOXENIX","version":"1.9.1","frame":"false","beta":"false","details":"XInbox allows you to tag posts before posting them, and see all your messages at once, and lets you delete multiple messages at once using the Mass Editor mode. To use this mode, go to your Inbox and click on the Mass Editor Mode button on your sidebar, click on the messages you want to delete then click the Delete Messages button.","file":"found","server":"up","errors":false,"slow":"false"}