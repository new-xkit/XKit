{"id":"post_crushes","script":"//* TITLE Post Crushes **//\r\n//* VERSION 2.0 REV A **//\r\n//* DESCRIPTION Lets you share your Tumblr Crushes **//\r\n//* DEVELOPER STUDIOXENIX **//\r\n//* DETAILS To use this extension, go to the 'Following' page on your dashboard, and click on the 'Post My Crushes' button below your Tumblr Crushes. **//\r\n//* FRAME false **//\r\n//* BETA false **//\r\n\r\nXKit.extensions.post_crushes = new Object({\r\n\r\n\trunning: false,\r\n\r\n\tpreferences: {\r\n\t\t\"sep0\": {\r\n\t\t\ttext: \"Appearance\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"default_title\": {\r\n\t\t\ttext: \"Default post title\",\r\n\t\t\ttype: \"text\",\r\n\t\t\tdefault: \"My Tumblr Crushes\",\r\n\t\t\tvalue: \"My Tumblr Crushes\"\r\n\t\t},\r\n\t\t\"show_percentage\": {\r\n\t\t\ttext: \"Show percentages on the post next to their usernames\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"sep1\": {\r\n\t\t\ttext: \"Tagging\",\r\n\t\t\ttype: \"separator\"\r\n\t\t},\r\n\t\t\"tag_people\": {\r\n\t\t\ttext: \"Tag the people in the post\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"auto_tag\": {\r\n\t\t\ttext: \"Auto-tag all my crush posts with a custom tag\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: true\r\n\t\t},\r\n\t\t\"auto_tag_text\": {\r\n\t\t\ttext:  \"Custom tag for all crush posts\",\r\n\t\t\ttype: \"text\",\r\n\t\t\tdefault: \"\",\r\n\t\t\tvalue: \"\"\r\n\t\t}\r\n\t},\r\n\r\n\trun: function() {\r\n\r\n\t\tif (document.location.href.indexOf(\"www.tumblr.com/following\") !== -1) {\r\n\t\t\tthis.put_button();\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tput_button: function() {\r\n\r\n\t\t$(\"#crushes\").after('<div class=\"xkit-button xkit-wide-button\" id=\"xkit_post_crushes\" style=\"display: block; font-size: 12px; font-weight: bold; text-align: center; margin-bottom: 10px; border-radius: 4px; margin-top: 15px;\">Post My Crushes</div>');\r\n\r\n\t\t$(\"#xkit_post_crushes\").click(function() {\r\n\t\t\tif($(this).hasClass(\"xkit_button_gray\") === true) { return; }\r\n\t\t\tXKit.extensions.post_crushes.post();\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tpost: function() {\r\n\r\n\t\tvar blog_url = $(\"#search_form\").find(\"[name='t']\").val();\r\n\t\tvar send_url = \"http://www.studioxenix.com/xkit/crushes/index.php\";\r\n\t\tvar send_string = \"?xkit=xkitnext\";\r\n\t\tvar crush_img = [];\r\n\t\tvar crush_name = [];\r\n\t\tvar crush_url = [];\r\n\t\tvar crush_val = [];\r\n\t\tvar i = 0;\r\n\r\n\t\t$(\"#xkit_post_crushes\").removeClass(\"xkit_button_green\");\r\n\t\t$(\"#xkit_post_crushes\").addClass(\"disabled\");\r\n\t\t$(\"#xkit_post_crushes\").html(\"Please wait...\");\r\n\r\n\t\tfor (i=1; i<=9; i++) {\r\n\t\t\tvar crush_img_src = $(\"#crush_\" + i).attr('style').substring($(\"#crush_\" + i).attr('style').indexOf(\"url('\") + 5);\r\n\t\t\t\tcrush_img_src = crush_img_src.substring(0, crush_img_src.indexOf(\"'\"));\r\n\t\t\tcrush_img.push(crush_img_src);\r\n\t\t\tcrush_url.push($(\"#crush_\" + i).attr('href'));\r\n\t\t\tcrush_name.push($(\"#crush_\" + i).attr('data-tumblelog-name'));\r\n\t\t\tcrush_val.push($(\"#crush_\" + i).find(\"span\").html().replace(\"%\",\"\"));\r\n\t\t}\r\n\r\n\t\tfor (i=0; i<=8; i++) {\r\n\t\t\tsend_string = send_string + \"&img\" + (i+1) + \"=\" + crush_img[i] + \"&val\" + (i+1) + \"=\" + crush_val[i];\r\n\t\t}\r\n\r\n\t\tsend_url = send_url + encodeURI(send_string);\r\n\r\n\t\tvar m_tags = \"\";\r\n\t\tvar send_txt = \"<strong>\" + XKit.extensions.post_crushes.preferences.default_title.value + \":</strong><ol>\";\r\n\r\n\t\tfor (i=0; i<=8; i++) {\r\n\t\t\tvar perc = '<small> (' + crush_val[i] + '%)</small>';\r\n\t\t\tif (XKit.extensions.post_crushes.preferences.show_percentage.value === false) { perc = \"\"; }\r\n\t\t\tsend_txt = send_txt + '<li><a href=\"' + crush_url[i] + '\">' + crush_name[i] + '</a>' + perc + '</li>';\r\n\t\t\tm_tags = m_tags + \",\" + crush_name[i];\r\n\t\t}\r\n\r\n\t\tsend_txt = send_txt + '</ol><p> </p>';\r\n\r\n\t\tvar m_object = {};\r\n\r\n\t\tm_object.channel_id = blog_url;\r\n\r\n\t\tm_object.form_key = $(\"#form_key\").val();\r\n\r\n\t\tm_object.context_page = \"dashboard\";\r\n\r\n\t\tm_object.context_id = \"dashboard\";\r\n\r\n\t\t// Not sure about this part:\r\n\t\tm_object[\"is_rich_text[one]\"] = \"0\";\r\n\t\tm_object[\"is_rich_text[two]\"] = \"1\";\r\n\t\tm_object[\"is_rich_text[three]\"] = \"0\";\r\n\r\n\t\tm_object.MAX_FILE_SIZE = \"10485760\";\r\n\r\n\t\tm_object[\"post[slug]\"] = \"\";\r\n\t\tm_object[\"post[draft_status]\"] = \"\";\r\n\t\tm_object[\"post[date]\"] =\"\";\r\n\r\n\r\n\t\tm_object[\"post[type]\"] = \"photo\";\r\n\r\n\t\tvar blog_selector_html = \"<select id=\\\"xkit-post-crushes-blog\\\" style=\\\"margin-top: 7px; width: 100%; -webkit-box-sizing: border-box; -moz-box-sizing: border-box;  box-sizing: border-box; height: 25px;\\\">\";\r\n\r\n\t\tvar m_blogs = XKit.tools.get_blogs();\r\n\r\n\t\tif (m_blogs === \"\") {\r\n\t\t\talert(\"Unable to Post Crushes\\nCan't get list of current blogs, please visit dashboard first.\");\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tfor(i=0;i<m_blogs.length;i++) {\r\n\t\t\t\tif (m_blogs[i] !== \"\") {\r\n\t\t\t\t\tblog_selector_html = blog_selector_html + \"<option value=\\\"\" + m_blogs[i] + \"\\\">\" + m_blogs[i] + \"</option>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tblog_selector_html = blog_selector_html + \"</select>\";\r\n\r\n\t\tif (XKit.extensions.post_crushes.preferences.tag_people.value === false) {\r\n\t\t\tm_object[\"post[tags]\"] = \"\";\r\n\t\t}else {\r\n\t\t\tm_object[\"post[tags]\"] = m_tags;\r\n\t\t}\r\n\t\tm_object[\"post[publish_on]\"] =\"\";\r\n\t\tm_object.custom_tweet = \"\";\r\n\r\n\t\tm_object[\"post[photoset_order]\"] = \"o1\";\r\n\t\tm_object[\"post[photoset_layout]\"] = \"1\";\r\n\t\tm_object[\"photo_src[]\"] = send_url;\r\n\t\tm_object[\"images[o1]\"] = send_url;\r\n\r\n\t\tXKit.window.show(\"Post Crushes\",\"<b>Post Caption:</b><input id=\\\"xkit-post-crushes-additional-text\\\" type=\\\"text\\\" class=\\\"xkit-textbox\\\" maxlength=\\\"256\\\" placeholder=\\\"optional additional text for this post\\\"><b>Blog to Post to:</b><br/>\" + blog_selector_html + \"<div style=\\\"margin-top: 10px; font-size: 13px; color: rgb(130,130,130);\\\">For additional options please check the Post Crushes control panel.</div>\",\"question\",\"<div data-status=\\\"0\\\" class=\\\"xkit-button default xkit-post-crushes-proceed\\\">Publish</div><div data-status=\\\"1\\\" class=\\\"xkit-button xkit-post-crushes-proceed\\\">Draft</div><div data-status=\\\"2\\\" class=\\\"xkit-button xkit-post-crushes-proceed\\\">Queue</div><div id=\\\"xkit-post-crushes-ignore\\\" class=\\\"xkit-button\\\">Cancel</div>\");\r\n\r\n\t\t$(\".xkit-post-crushes-proceed\").click(function() {\r\n\r\n\t\t\tif ($(this).hasClass(\"disabled\")) { return; }\r\n\r\n\t\t\tm_object[\"post[state]\"] = $(this).attr('data-status');\r\n\r\n\t\t\tvar m_text = $.trim($(\"#xkit-post-crushes-additional-text\").val());\r\n\r\n\t\t\tif (m_text !== \"\") {\r\n\t\t\t\tm_object[\"post[two]\"] = send_txt + \"<p>\" + m_text + \"</p>\";\r\n\t\t\t} else {\r\n\t\t\t\tm_object[\"post[two]\"] = send_txt;\r\n\t\t\t}\r\n\r\n\t\t\tm_object.channel_id = $(\"#xkit-post-crushes-blog\").val();\r\n\r\n\t\t\t$(\"#xkit-window .xkit-button\").addClass(\"disabled\");\r\n\r\n\t\t\t$(\"#xkit-post-crushes-additional-text, #xkit-post-crushes-blog\").attr('disabled', 'disabled');\r\n\r\n\t\t\tXKit.extensions.post_crushes.actually_post(m_object);\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-post-crushes-ignore\").click(function() {\r\n\r\n\t\t\tif ($(this).hasClass(\"disabled\")) { return; }\r\n\r\n\t\t\t$(\"#xkit_post_crushes\").addClass(\"xkit_button_green\");\r\n\t\t\t$(\"#xkit_post_crushes\").removeClass(\"disabled\");\r\n\t\t\t$(\"#xkit_post_crushes\").html(\"Post My Crushes\");\r\n\r\n\t\t\tXKit.window.close();\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tactually_post: function(m_object) {\r\n\r\n\t\tXKit.interface.kitty.get(function(kitty_data) {\r\n\r\n\t\t\tif (kitty_data.errors === true) {\r\n\r\n\t\t\t\tXKit.extensions.post_crushes.post_crushes_error(\"Can't post crushes\", \"Unable to authorize post transaction. Please try again later.\");\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tGM_xmlhttpRequest({\r\n\t\t\t\tmethod: \"POST\",\r\n\t\t\t\turl: \"http://www.tumblr.com/svc/post/update\",\r\n\t\t\t\tdata: JSON.stringify(m_object),\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"X-tumblr-puppies\": kitty_data.kitten,\r\n\t\t\t\t\t\"X-tumblr-form-key\": XKit.interface.form_key(),\r\n\t\t\t\t\t\"Content-Type\": \"application/json\"\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function(response) {\r\n\t\t\t\t\tXKit.interface.kitty.set(\"\");\r\n\t\t\t\t\tXKit.extensions.post_crushes.post_crushes_error(\"Can't post crushes\", \"Server returned invalid/blank page or could not be reached. Maybe you hit your post limit for today, or your account has been suspended. Please check your internet connection and try again later.\");\r\n\t\t\t\t},\r\n\t\t\t\tonload: function(response) {\r\n\t\t\t\t\tXKit.interface.kitty.set(response.getResponseHeader(\"X-tumblr-kittens\"));\r\n\t\t\t\t\tvar m_obj = jQuery.parseJSON(response.responseText);\r\n\t\t\t\t\tconsole.log(m_obj);\r\n\t\t\t\t\tif (m_obj.errors === false) {\r\n\t\t\t\t\t\t$(\"#xkit_post_crushes\").html(\"Posted!\");\r\n\t\t\t\t\t\tXKit.window.close();\r\n\t\t\t\t\t\tif (m_object[\"post[state]\"] === \"0\") {\r\n\t\t\t\t\t\t\tXKit.notifications.add(\"Your crushes have been posted to <b>\" + m_object.channel_id + \"</b>\", \"ok\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (m_object[\"post[state]\"] === \"1\") {\r\n\t\t\t\t\t\t\tXKit.notifications.add(\"Your crushes have been drafted to <b>\" + m_object.channel_id + \"</b>\", \"ok\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (m_object[\"post[state]\"] === \"2\") {\r\n\t\t\t\t\t\t\tXKit.notifications.add(\"Your crushes have been queued to <b>\" + m_object.channel_id + \"</b>\", \"ok\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tXKit.extensions.post_crushes.post_crushes_error(\"Can't post crushes\", \"Server returned a non-JSON object. Maybe you hit your post limit for today, or your account has been suspended. Please try again later.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tpost_crushes_error: function(title, message) {\r\n\r\n\t\tXKit.window.show(title, message, \"error\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\t$(\"#xkit_post_crushes\").remove();\r\n\t}\r\n\r\n});\r\n","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjY0RDkxMTVCMzFEMTFFMkJGQjZENkUwMjNDREIzNjUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjY0RDkxMTZCMzFEMTFFMkJGQjZENkUwMjNDREIzNjUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MDQxOUJCNkIzMTkxMUUyQkZCNkQ2RTAyM0NEQjM2NSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyNjREOTExNEIzMUQxMUUyQkZCNkQ2RTAyM0NEQjM2NSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgVv98EAAAbhSURBVHjajJZ7bFVV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","title":"Post Crushes","description":"Lets you share your Tumblr Crushes","developer":"STUDIOXENIX","version":"2.0 REV A","frame":"false","beta":"false","details":"To use this extension, go to the 'Following' page on your dashboard, and click on the 'Post My Crushes' button below your Tumblr Crushes.","file":"found","server":"up","errors":false,"slow":"false"}